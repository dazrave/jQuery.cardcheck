/*!
 * jQuery.cardcheck
 * A plugin for detecting and validating credit cards
 * 
 * https://github.com/unruthless/jQuery.cardcheck
 * 
 * Copyright (c) 2010 Ruthie BenDor and Tim Branyen
 * Dual licensed under the MIT and GPL licenses.
 * 
 */
(function(j,l,e){var g;e.cardcheck=function(a){var c=g.types||[],d=typeof a==="string"?a:a.num;a=d.length;var b,h=false,i=false;e.each(c,function(f,k){if(k.checkType(d)){b=f;return false}});if(d&&c&&c[b]){h=c[b].checkLength(a);i=g.checkLuhn(d,a)}return{type:b,validLen:h,validLuhn:i}};e.fn.cardcheck=function(a){if(a&&e.isFunction(a)){var c=e({},g);c.callback=a;a=c}else a=e.extend({},g,a);return this.bind("keyup",function(){var d=a.types||{},b=this.value,h="",i="",f=e.cardcheck({num:b});if(typeof f.type=== "number"){h=d[f.type].name;i=d[f.type].className}a.callback.call(this,{num:b,len:b.length,cardName:h,cardClass:i,validLen:f.validLen,validLuhn:f.validLuhn,opts:a})})};g=e.fn.cardcheck.opts={checkLuhn:function(a,c){if(!a||!c)return false;a=a.split("").reverse();var d=0,b;for(b=0;b<c;b++){a[b]=j.parseInt(a[b],10);d+=b%2?2*a[b]-(a[b]>4?9:0):a[b]}return d%10===0},types:[{name:"Visa",className:"visa",checkType:function(a){return a.charAt(0)==="4"},checkLength:function(a){return a===13||a===16}},{name:"American Express", className:"amex",checkType:function(a){return a.charAt(0)==="3"},checkLength:function(a){return a===15}},{name:"MasterCard",className:"mastercard",checkType:function(a){return a.charAt(0)==="5"},checkLength:function(a){return a===16}},{name:"Discover",className:"discover",checkType:function(a){return a.charAt(0)==="6"},checkLength:function(a){return a===16}}],callback:e.noop}})(this,this.document,this.jQuery);
