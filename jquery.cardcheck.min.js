/*!
 * jQuery.cardcheck
 * A plugin for detecting and validating credit cards
 * 
 * https://github.com/unruthless/jQuery.cardcheck
 * 
 * Copyright (c) 2010 Ruthie BenDor and Tim Branyen
 * Dual licensed under the MIT and GPL licenses.
 * 
 */
(function(i,l,e){var g;e.cardcheck=function(a){var d=g.types||{},c=typeof a==="string"?a:a.num;a=c.length;var b,h=false,f=false;e.each(d,function(j,k){if(k.checkType(c)){b=j;return false}});if(c&&d&&d[b]){h=d[b].checkLength(a);f=g.checkLuhn(c,a)}return{type:b,validLen:h,validLuhn:f}};e.fn.cardcheck=function(a){if(a&&e.isFunction(a)){g.callback=a;a=g}else a=e.extend({},g,a);return this.bind("keyup",function(){var d=a.types||{},c=this.value,b="",h="",f=e.cardcheck({num:c});if(typeof f.type==="number"){b= d[f.type].name;h=d[f.type].className}a.callback.call(this,{num:c,len:c.length,cardName:b,cardClass:h,validLen:f.validLen,validLuhn:f.validLuhn,opts:a})})};g=e.fn.cardcheck.opts={checkLuhn:function(a,d){if(!a||!d)return false;a=a.split("").reverse();var c=0,b;for(b=0;b<d;b++){a[b]=i.parseInt(a[b],10);c+=b%2?2*a[b]-(a[b]>4?9:0):a[b]}return c%10===0},types:[{name:"Visa",className:"visa",checkType:function(a){return a[0]==="4"},checkLength:function(a){return a===13||a===16}},{name:"American Express", className:"amex",checkType:function(a){return a[0]==="3"},checkLength:function(a){return a===15}},{name:"MasterCard",className:"mastercard",checkType:function(a){return a[0]==="5"},checkLength:function(a){return a===16}},{name:"Discover",className:"discover",checkType:function(a){return a[0]==="6"},checkLength:function(a){return a===16}}],callback:e.noop}})(this,this.document,this.jQuery);
